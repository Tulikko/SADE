---
title: "Week 2"
author: "Uine Kailamäki"
date: "2021"
output: html_document
---


# 2: Point Pattern Analysis

Text

## Point Densities

```{r}
# Importing the data
library(rgdal)
library(raster)
library(spatstat)
library(maptools)

setwd("~/R/SADE/week2")
polyg <- readOGR(dsn="englandwales", layer="engwales_simple")

# Info about readOGR function
?readOGR

# Digital Elevation Model (DEM) taken from NASA’s Shuttle Radar Topography Mission data
dem <- raster("dem/engwales_dem.tif")
plot(polyg)
plot(dem, add=T)

# Change the color scheme to more intuitive one
plot(dem, add=T, col=terrain.colors(5))

# Loading medieval market sites from Samantha Letters’s (2002) Gazetteer of Markets and Fairs in England and Wales to 1516.
markets <- readOGR(dsn="markets1334", layer="markets1334")
points(markets, pch=19, cex=0.2)

class(markets)
head(markets, n=10)

# Manipulating the data: 

# Lets make sure that the two have the same coordinate reference system (CRS) by taking the polygon’s CRS and applying it to the markets.
markets <- spTransform(markets, CRS(proj4string(polyg)))

# Subsetting the markets within the polygon's area to drop out those that fall outside of its borders
markets <- markets[polyg, ]

# Markets are events rather than places - let's save the data that contains duplicates as "market_events" and then remove duplicates from "markets"
market_events <- markets
markets <- remove.duplicates(markets)

# Creating spastat object from markets
# sp_markets <- as.ppp(coordinates(markets), as.owin(polyg))


```

## Relative risk surface

```{r}


```

## Nearest Neighbour

```{r}


```